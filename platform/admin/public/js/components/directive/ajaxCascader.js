(function(){"use strict";Vue.component("i-ajax-cascader",Janfish.extend({props:["value","placeholder","max-level","clearable","model","attribute","conditions","relation-attribute"],data:function(){return{options:[],level:0}},render:function(a){var b=this;b.maxLevel=!b.maxLevel?2:b.maxLevel;b.clearable=b.clearable===undefined?true:b.clearable;b.placeholder=b.placeholder===undefined?"请选择":b.placeholder;return a("Cascader",{on:{"on-change":function(a){b.$emit("input",a.splice(b.maxLevel-1,1))}},props:{data:b.options,placeholder:b.placeholder,clearable:b.clearable,"load-data":function(a,c){var d;a.loading=true;b.loadOptions(a.value,function(e){if(b.level<b.maxLevel){for(d in e){e[d].loading=false;e[d].children=[]}}a.children=e;a.loading=false;c()})}}})},methods:{loadOptions:function(a,b){var c=this,d=this.model||"",e=this.attribute||"",f=this.relationAttribute||"parent_id",g=this.conditions||{time:+new Date};if(!d||!e){c.$Message.error("参数错误");return false}g=g?JSON.stringify(g):"";a=a||"";c.$http.post("/resource/cascader",qs.stringify({relation_attribute:f,model:d,attribute:e,parent_id:a,conditions:g})).then(function(a){if(a.status!=="success"){c.$Message.error(a.data.message);return false}c.level++;b(a.data.data)})}},mounted:function(){var a=this,b;a.loadOptions("",function(c){for(b in c){c[b].loading=false;c[b].children=[]}a.options=c})}}))})();